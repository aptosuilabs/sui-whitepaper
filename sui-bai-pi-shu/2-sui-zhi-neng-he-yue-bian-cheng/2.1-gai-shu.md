# 2.1 概述

Sui 的全局状态包括一个由 Move 包创建和管理的可编程对象池，这些包是包含 Move 函数和类型的 Move 模块的集合（详见第 2.1.1 节）。 移动包本身也是对象。 因此，Sui 对象可以分为两类：

• 结构数据值：由移动模块管理的类型化数据。 每个对象都是一个结构值，其字段可以包含原始类型（例如整数、地址）、其他对象和非对象结构。

• 包代码值：作为原子单元发布的一组相关移动字节码模块。 包中的每个模块既可以依赖于该包中的其他模块，也可以依赖于先前发布的包中的模块.

对象可以对资产进行编码（例如，可替代或不可替代的代币）、授予调用某些函数或创建其他对象的权限的能力、管理其他资产的“智能合约”等等——由程序员决定。 声明自定义 Sui 对象类型的 Move 代码如下所示：

struct Obj has key {\
id: VersionedID, // globally unique ID and version\
f: u64 // objects can have primitive fields\
g: OtherObj // fields can also store other objects\
}

所有表示 Sui 对象的结构体（但不是所有 Move 结构体值）都必须具有 id 字段和指示该值可以存储在 Sui 的全局对象池中的 key 能力。

2.1.1 模块: 一个 Move 程序被组织成一组模块，每个模块都包含一个结构声明和函数声明的列表。 一个模块可以从其他模块导入结构类型并调用其他模块声明的函数。

在一个 Move 模块中声明的值可以流入另一个模块——

例如，上面示例中的模块 OtherObj 可以在与定义 Obj 的模块不同的模块中定义。 这与大多数智能合约语言不同，后者只允许非结构化字节跨合约边界流动。 然而，Move 能够支持这一点，因为它提供了封装特性来帮助程序员编写健壮安全的 \[14] 代码。 具体来说，Move 的类型系统确保像上面的 Obj 这样的类型只能由以下人员创建、销毁、复制、读取和写入声明类型的模块内的函数。 这允许模块对其声明的类型强制执行强不变量，即使它们流过智能合约信任边界，它们也会继续保持不变。

2.1.2 事务和入口点: 全局对象池通过可以创建、销毁、读取和写入对象的事务进行更新。 事务必须将它希望操作的每个现有对象作为输入。 此外，事务必须包括包对象的版本 ID、包内的模块和函数的名称以及函数的参数（包括输入对象）。 例如，调用函数

public fun entrypoint(\
o1: Obj, o2: \&mut Obj, o3: \&Obj, x: u64, ctx: \&mut TxContext\
) { ... }

一个事务必须为三个不同的对象提供 ID，它们的类型是 Obj 和一个要绑定到 x 的整数。 TxContext 是由运行时填充的特殊参数，其中包含发送者地址和创建新对象所需的信息。

入口点的输入（更一般地说，任何 Move 函数）的输入可以使用类型中编码的不同可变性权限进行传递。 可以读取、写入、传输或销毁 Obj 输入。 \&mut Obj 输入只能读取或写入，\&Obj 只能读取。 交易发送者必须被授权使用具有指定可变性权限的每个输入对象——有关更多详细信息，请参见第 4.4 节。

2.1.3 创建和传输对象: 程序员可以通过使用传入入口点的 TxContext 为对象生成新的 ID 来创建对象：

public fun create\_then\_transfer(\
f: u64, g: OtherObj, o1: Obj, ctx: \&mut TxContext\
) {\
let o2 = Obj { id: TxContext::fresh\_id(ctx), f, g };\
Transfer::transfer(o1, TxContext:sender());\
Transfer::transfer(o2, TxContext:sender());\
}

此代码以 OtherObj 和 Obj 类型的两个对象作为输入，使用第一个对象和生成的 ID 创建一个新的 Obj，然后将这两个 Obj 对象传输给交易发送者。 一旦一个对象被转移，它就会流入全局对象池，并且在事务的其余部分中不能被代码访问。 Transfer 模块是 Sui 标准库的一部分，其中包括将对象传输到用户地址和其他对象的函数。

我们注意到，如果程序员代码忽略包含其中一个传输调用，则此代码将被 Move 类型系统拒绝。 Move 强制执行资源安全 \[5] 保护，以确保无法在未经许可的情况下创建对象、复制对象或意外销毁对象。 资源安全的另一个例子是尝试传输同一个对象两次，这也将被 Move 类型系统拒绝。
